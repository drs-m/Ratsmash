<script type="text/javascript">
	window.addEventListener('load',function(){

		var canvas = document.getElementById('resultCanvas');
		var context = canvas.getContext('2d');
		var radius = 200;

		//Tortenst端ck Platz 1
		context.beginPath();
		context.moveTo(document.getElementById('resultCanvas').width/2,document.getElementById('resultCanvas').height/2);
		context.arc(document.getElementById('resultCanvas').width/2,document.getElementById('resultCanvas').height/2,radius,0,2*Math.PI*<%= @categoryResults[0][2] %>,false);
		context.fillStyle = "rgb(255,0,0)";
		context.fill();
		context.closePath();

		//Tortenst端ck Platz 2
		context.beginPath();
		context.moveTo(document.getElementById('resultCanvas').width/2,document.getElementById('resultCanvas').height/2);
		context.arc(document.getElementById('resultCanvas').width/2,document.getElementById('resultCanvas').height/2,radius,2*Math.PI*<%= @categoryResults[0][2] %>,2*Math.PI*(<%= @categoryResults[0][2] %> + <%= @categoryResults[1][2] %>),false);
		context.fillStyle = "rgb(0,255,0)";
		context.fill();
		context.closePath();

		//Tortenst端ck Platz 3
		context.beginPath();
		context.moveTo(document.getElementById('resultCanvas').width/2,document.getElementById('resultCanvas').height/2);
		context.arc(document.getElementById('resultCanvas').width/2,document.getElementById('resultCanvas').height/2,radius,2*Math.PI*(<%= @categoryResults[0][2] %> + <%= @categoryResults[1][2] %>),2*Math.PI*(<%= @categoryResults[0][2] %> + <%= @categoryResults[1][2] %> + <%= @categoryResults[2][2] %>),false);
		context.fillStyle = "rgb(0,0,255)";
		context.fill();
		context.closePath();

		//Tortenst端ck Andere
		context.beginPath();
		context.moveTo(document.getElementById('resultCanvas').width/2,document.getElementById('resultCanvas').height/2);
		context.arc(document.getElementById('resultCanvas').width/2,document.getElementById('resultCanvas').height/2,radius,2*Math.PI*(<%= @categoryResults[0][2] %> + <%= @categoryResults[1][2] %> + <%= @categoryResults[2][2] %>),2*Math.PI*1.0,false);
		context.fillStyle = "rgb(255,255,0)";
		context.fill();
		context.closePath();

	}, false);
</script>
<h2>Ergebnisse</h2>
<%= form_tag "", method: :get do %>
	Kategorie: <select name="category_id">
		<% Category.all.each do |category| %>
			<option value="<%= category.id %>"><%= category.name %> (<%= Group.find_by_id(category.group_id).name %>)</option>
		<% end %>
	</select>
	<%= submit_tag "Zeigen" %>
<% end %>
<canvas id="resultCanvas" width="800px" height="600px"></canvas>

<table>
	<thead>
		<tr>
			<th>Gruppe</th>
			<th>Kategorie</th>
			<th>1. Platz</th>
			<th>2. Platz</th>
			<th>3. Platz</th>
		</tr>
	</thead>
	<tbody>
		<% @results.each do |result| %>
			<tr>
				<td><%= Group.find_by_id(Category.find_by_id(result[:category_id]).group_id).name %></td>
				<td><%= Category.find_by_id(result[:category_id]).name %>(<%= Category.find_by_id(result[:category_id]).id %>)</td>
				<% result[:ranking].each do |voted| %>
					<td><%= voted["name"] + " (" + voted["points"].to_s + ")" %></td>
				<% end %>
			</tr>
		<% end %>
	</tbody>
</table>